# 常用数据结构

首先看数据结构的知识点都有哪些，如下图所示。

![img](http://s0.lgstatic.com/i/image2/M01/8A/E1/CgotOV14oT6AJUiFAACk7j7acPA736.png)



1. 队列和栈是经常使用的数据结构，需要了解它们的特点。队列是先进先出，栈是后进先出。

2. 表，包括很多种，有占用连续空间的数组、用指针链接的单向和双向链表，首尾相接的循环链表、以及散列表，也叫哈希表。

3. 图，在特定领域使用的比较多，例如路由算法中会经常使用到，图分为有向图、无向图及带权图，这部分需要掌握图的深度遍历和广度遍历算法，了解最短路径算法。

4. 树的内容，树一般用作查找与排序的辅助结构，剩下两个部分都和树有关，一个是二叉树，一个是多叉树。

5. 多叉树包括 B 树族，有 B 树、B+ 树、B* 树，比较适合用来做文件检索；另外一个是字典树，适合进行字符串的多模匹配。

6. 二叉树包括平衡二叉树、红黑树、哈夫曼树，以及堆，适合用于进行数据查找和排序。这部分需要了解二叉树的构建、插入、删除操作的实现，需要掌握二叉树的前序、中序、后序遍历。

## 二叉搜索树

如下图所示，二叉搜索树满足这样的条件，每个节点包含一个值，每个节点至多有两个子树。每个节点左子树节点的值都小于自身的值，每个节点右子树节点的值都大于自身的值。

![img](http://s0.lgstatic.com/i/image2/M01/8A/E1/CgotOV14oT6AIEwmAAAW0UV9vPM694.png)

二叉树的查询时间复杂度是 log(N)，但是随着不断的插入、删除节点，二叉树的树高可能会不断变大，当一个二叉搜索树所有节点都只有左子树或者都只有右子树时，其查找性能就退化成线性的了。

## 平衡二叉树

平衡二叉树可以解决上面这个问题，平衡二叉树保证每个节点左右子树的高度差的绝对值不超过 1，例如 AVL 树。AVL 树是严格的平衡二叉树，插入或删除数据时可能经常需要旋转来保持平衡，比较适合插入、删除比较少的场景。

## 红黑树

红黑树是一种更加实用的非严格的平衡二叉树。红黑树更关注局部平衡而非整体平衡，确保没有一条路径会比其他路径长出 2 倍，所以是接近平衡的，但减少了许多不必要的旋转操作，更加实用。前面提到过，Java 8 的 HashMap 中就应用了红黑树来解决散列冲突时的查找问题。TreeMap 也是通过红黑树来保证有序性的。

红黑树除了拥有二叉搜索树的特点外，还有以下规则，如下图所示。

![img](http://s0.lgstatic.com/i/image2/M01/8A/C2/CgoB5l14oT6AeAxdAAAmJsTBAww115.png)

红黑树特点如下：

1. 每个节点不是红色就是黑色。
2. 根节点是黑色。

3. 每个叶子节点都是黑色的空节点，如图中的黑色三角。

4. 红色节点的两个子节点都是黑色的。

5. 任意节点到其叶节点的每条路径上，包含相同数量的黑色节点。

## B 树

B 树是一种多叉树，也叫多路搜索树。B 树中每个节点可以存储多个元素，非常适合用在文件索引上，可以有效减少磁盘 IO 次数。B 树中所有结点的最大子节点数称为 B 树的阶，如下图所示是一棵 3 阶 B 树，也叫 2-3 树。

![img](http://s0.lgstatic.com/i/image2/M01/8A/E1/CgotOV14oT6APZerAAAkJXd9qEE912.png)

一个 m 阶 B 树有如下特点：

1. 非叶节点最多有 m 棵子树；

2. 根节点最少有两个子树，非根、非叶节点最少有 m/2 棵子树；

3. 非叶子结点中保存的关键字个数，等于该节点子树个数−1，就是说一个节点如果有 3棵子树，那么其中必定包含 2 个关键字；

4. 非叶子节点中的关键字大小有序，如上图中左边的节点中 37、51 两个元素就是有序的；

5. 节点中每个关键字的左子树中的关键字都小于该关键字，右子树中的关键字都大于该关键字。如上图中关键字 51 的左子树有 42、49，都小于 51，右子树的节点有 59，大于51；

6. 所有叶节点都在同一层。


B 树在查找时，从根结点开始，对结点内的有序的关键字序列进行二分查找，如果找到就结束，没有找到就进入查询关键字所属范围的子树进行查找，直到叶节点。

**总结一下：**

- B 树的关键字分布在整颗树中，一个关键字只出现在一个节点中；

- 搜索可能在非叶节点停止；

- B 树一般应用在文件系统。

## B+ 树

下图是 B 树的一个变种，叫作 B+ 树。

![img](http://s0.lgstatic.com/i/image2/M01/8A/C2/CgoB5l14oT6AUR7GAAAe0Dk9-gg936.png)

B+ 树的定义与 B 树基本相同，除了下面这几个特点。

1. 节点中的关键字与子树数目相同，比如节点中有 3 个关键字，那么就有 3 棵子树；

2. 关键字对应的子树中的节点都大于或等于关键字，子树中包括关键字自身；

3. 所有关键字都出现在叶子节点中；

4. 所有叶子节点都有指向下一个叶子节点的指针。


**与 B 树不同，B+ 树在搜索时不会在非叶子节点命中，一定会查询到叶子节点；另外一个，叶子节点相当于数据存储层，保存关键字对应的数据，而非叶子节点只保存关键字和指向叶节点的指针，不保存关键字对应的数据，所以同样数量关键字的非叶节点，B+ 树比 B 树要小很多。**

**（重点）**B+ 树更适合索引系统，MySQL 数据库的索引就提供了 B+ 树实现。原因有三个：

1. 由于叶节点之间有指针相连，B+ 树更适合范围检索；

2. 由于非页节点只保存关键字和指针，同样大小非叶节点，B+ 树可以容纳更多的关键字，可以降低树高，查询时磁盘读写代价更低；

3. B+ 树的查询效率比较稳定。任何关键字的查找必须走一条从根结点到叶子结点的路，所有关键字查询的路径长度相同，效率相当。

4. 最后可以简单了解，还有一种 B* 树的变种，在 B+ 树的非叶节点上，也增加了指向同一层下一个非叶节点的指针。